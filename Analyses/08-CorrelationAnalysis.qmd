---
title: "08-Correlation Analysis"
author: "Insert Your Name Here"
date: '`r format(Sys.Date(), "%B %d, %Y")`'
format:
  html:
    toc: true
    toc-depth: 4
    number-sections: true
    number-depth: 4
    code-fold: show
    echo: true
    error: true
    embed-resources: true
    self-contained-math: true
---

# Intro

This is a [Quarto](https://quarto.org) file.
Quarto enables you to weave together content and executable code into a finished document.
When you execute code within the notebook, the results appear beneath the code. 
This allows you to share your analyses and results with others so that they can see the results in line with the code for reproducibility.
Make sure to have only one sentence per line.
To learn more about Quarto see <https://quarto.org>.
For course instructions on using Quarto, see here: <https://isaactpetersen.github.io/QuartoBlogFantasyFootball/posts/quarto-instructions/>.

# Preamble

## Install Libraries

```{r}
#install.packages("remotes")
#remotes::install_github("DevPsyLab/petersenlab")
#remotes::install_github("FantasyFootballAnalytics/ffanalytics")

#update.packages(ask = FALSE)
```

## Load Libraries

```{r}
#| message: false
#| warning: false

library("petersenlab")
library("XICOR")
library("psych")
library("DescTools")
library("psych")
library("correlation")
library("effectsize")
library("GGally")
library("ggridges")
library("tidyverse")
```

## Load Data

Load the data file that is in the following location: `./Data/player_stats_weekly.Rdata` (if running locally) or `../Data/player_stats_weekly.Rdata` (if rendering).

```{r}
load("../Data/player_stats_weekly.Rdata")
```

# Correlation Coefficient

What is the association (*r*- and *p*-value) between target share (`target_share`) and fantasy points (`fantasyPoints`) among WRs?

```{r}
cor.test(
  ~ target_share + fantasyPoints,
  data = player_stats_weekly %>% filter(position == "WR")
)
```

# Correlation Matrix

Provide a correlation matrix (of *r*, *n*, and *p*-values) of the following variables among WRs: age, height, target share (`target_share`), and fantasy points (`fantasyPoints`).

```{r}
petersenlab::cor.table(
  player_stats_weekly %>% filter(position == "WR") %>% select(age, height, target_share, fantasyPoints)
)
```

# Correlogram (Correlation Matrix Plot)

```{r}
GGally::ggcorr(
  player_stats_weekly %>% filter(position == "WR") %>% select(height, weight, target_share, fantasyPoints),
  label = TRUE,
  label_round = 2)
```

# Scatterplot with Best-Fit Line

Provide a scatterplot with a best-fit line of the association between target share (`target_share`) and fantasy points (`fantasyPoints`) among WRs.
Have target share on the x-axis and fantasy points on the y-axis.
What is the shape of the association?

```{r}
ggplot2::ggplot(
  data = player_stats_weekly %>% filter(position == "WR"),
  aes(
    x = target_share,
    y = fantasyPoints)) +
  geom_point() +
  geom_smooth(
    method = "lm",  # linear best-fit line
    color = "red") +
  geom_smooth(
    method = "gam", # nonlinear best-fit line
    color = "blue"
  ) +
  labs(
    x = "Targets",
    y = "Fantasy Points",
    title = "Correlation between Targets and Fantasy Points"
  )
```

# Session Info

```{r}
sessionInfo()
```

